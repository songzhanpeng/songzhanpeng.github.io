---
title: 定时提醒小助手
description: 定时提醒小助手
date: 2023-07-21
tags:
  - javascript
---

# 定时提醒小助手

```javascript
// ==UserScript==
// @name         提醒喝水小助手
// @namespace    https://bbs.tampermonkey.net.cn/
// @version      0.1.0
// @description  工作日每半个小时提醒你喝水,定时时间可以自行修改
// @author       yinyuejun
// @crontab      */30 10-20/1 * * 1-5
// @grant        GM_notification
// @console log
// ==/UserScript==

const Roles = {
    "1001": {
        "id": "1001",
        "name": "三月七"
    },
    "1002": {
        "id": "1002",
        "name": "丹恒"
    },
    "1003": {
        "id": "1003",
        "name": "姬子"
    },
    "1004": {
        "id": "1004",
        "name": "瓦尔特"
    },
    "1005": {
        "id": "1005",
        "name": "卡芙卡"
    },
    "1006": {
        "id": "1006",
        "name": "银狼"
    },
    "1008": {
        "id": "1008",
        "name": "阿兰"
    },
    "1009": {
        "id": "1009",
        "name": "艾丝妲"
    },
    "1013": {
        "id": "1013",
        "name": "黑塔"
    },
    "1101": {
        "id": "1101",
        "name": "布洛妮娅"
    },
    "1102": {
        "id": "1102",
        "name": "希儿"
    },
    "1103": {
        "id": "1103",
        "name": "希露瓦"
    },
    "1104": {
        "id": "1104",
        "name": "杰帕德"
    },
    "1105": {
        "id": "1105",
        "name": "娜塔莎"
    },
    "1106": {
        "id": "1106",
        "name": "佩拉"
    },
    "1107": {
        "id": "1107",
        "name": "克拉拉"
    },
    "1108": {
        "id": "1108",
        "name": "桑博"
    },
    "1109": {
        "id": "1109",
        "name": "虎克"
    },
    "1201": {
        "id": "1201",
        "name": "青雀"
    },
    "1202": {
        "id": "1202",
        "name": "停云"
    },
    "1203": {
        "id": "1203",
        "name": "罗刹"
    },
    "1204": {
        "id": "1204",
        "name": "景元"
    },
    "1206": {
        "id": "1206",
        "name": "素裳"
    },
    "1209": {
        "id": "1209",
        "name": "彦卿"
    },
    "1211": {
        "id": "1211",
        "name": "白露"
    },
    // "8001": {
    //     "id": "8001",
    //     "name": "开拓者 (物理)"
    // },
    // "8002": {
    //     "id": "8002",
    //     "name": "开拓者 (物理)"
    // },
    // "8003": {
    //     "id": "8003",
    //     "name": "开拓者 (火)"
    // },
    // "8004": {
    //     "id": "8004",
    //     "name": "开拓者 (火)"
    // }
}

function getAvatarAndImage(id) {
    const baseUrl = "https://gitee.com/hewang1an/StarRail-plugin/raw/main/resources/panel/resources";
    return {
        avatarUrl: baseUrl + `/avatar/${id}.png`,
        charImageUrl: baseUrl + `/char_image/${id}.png`,
    }
}

function getRandomRole(id) {
    if (id) {
        const role = Roles[id]
        if (role) {
            const { avatarUrl, charImageUrl } = getAvatarAndImage(role.id)
            return {
                id: role.id,
                name: role.name,
                avatar: avatarUrl,
                charImage: charImageUrl
            };
        } else {
            console.warn('Role not found', id)
        }
    } else {
        // 随机角色
        const roleList = Object.entries(Roles);
        const randomIndex = Math.floor(Math.random() * roleList.length);
        const roleInfo = roleList[randomIndex];
        const { avatarUrl, charImageUrl } = getAvatarAndImage(roleInfo[0])
        return {
            id: roleInfo[1].id,
            name: roleInfo[1].name,
            avatar: avatarUrl,
            charImage: charImageUrl
        };
    }

}

return new Promise((resolve, reject) => {

    const currentDate = new Date();
    const currentHour = currentDate.getHours();

    if (currentHour >= 9 && currentHour <= 20) {
        const { name, avatar } = getRandomRole(1005)

        GM_notification({
            title: `${name}的温馨提醒`,
            text: "亲爱的，是时候喝杯水休息一下了",
            image: avatar,
            ondone: () => {
                resolve();
            }
        });
    }
});

```
